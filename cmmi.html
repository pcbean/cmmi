<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>ä¿¡æ¯å®‰å…¨èƒ½åŠ›æˆç†Ÿåº¦è¯„ä¼°ç³»ç»Ÿ</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.2.0"></script>
<style>
  :root {
    --primary-color: #667eea;
    --primary-dark: #764ba2;
    --theme-color: #f093fb;
  }
  * {
    margin: 0; padding: 0; box-sizing: border-box;
  }
  body {
    font-family: 'Microsoft YaHei', Arial, sans-serif;
    background: linear-gradient(135deg, var(--primary-color) 0%, var(--primary-dark) 100%);
    padding: 20px;
    min-height: 100vh;
  }
  .container {
    max-width: 1800px;
    margin: 0 auto;
    background: white;
    border-radius: 20px;
    box-shadow: 0 20px 60px rgba(0,0,0,0.3);
    overflow: hidden;
  }
  .header {
    background: linear-gradient(135deg, var(--primary-color) 0%, var(--primary-dark) 100%);
    color: white;
    padding: 40px;
    text-align: center;
    position: relative;
  }
  .header h1 {
    font-size: 32px;
    margin-bottom: 10px;
    font-weight: 600;
  }
  .header p {
    font-size: 16px;
    opacity: 0.9;
  }
  .header .mode-badge {
    display: inline-block;
    background: rgba(255,255,255,0.2);
    padding: 8px 20px;
    border-radius: 20px;
    margin-top: 10px;
    font-size: 14px;
    font-weight: 500;
  }
  .color-picker-container {
    position: absolute;
    top: 20px;
    right: 40px;
    background: rgba(255,255,255,0.2);
    padding: 15px;
    border-radius: 10px;
    backdrop-filter: blur(10px);
  }
  .color-picker-container label {
    display: block;
    font-size: 14px;
    margin-bottom: 8px;
    font-weight: 500;
  }
  .color-input-group {
    display: flex;
    gap: 10px;
    align-items: center;
  }
  .color-input-group input[type="color"] {
    width: 50px;
    height: 40px;
    border: 2px solid white;
    border-radius: 8px;
    cursor: pointer;
  }
  .color-input-group input[type="text"] {
    width: 100px;
    padding: 8px;
    border: 2px solid white;
    border-radius: 8px;
    background: rgba(255,255,255,0.9);
    font-size: 14px;
  }
  .content {
    padding: 40px;
  }
  .input-section {
    background: #f8f9fa;
    border-radius: 15px;
    padding: 30px;
    margin-bottom: 30px;
  }
  .input-section h2 {
    color: #333;
    margin-bottom: 25px;
    font-size: 24px;
    border-bottom: 3px solid var(--primary-color);
    padding-bottom: 10px;
  }
  .calculation-mode {
    background: white;
    padding: 20px;
    border-radius: 12px;
    margin-bottom: 25px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.08);
  }
  .calculation-mode h3 {
    font-size: 16px;
    color: #333;
    margin-bottom: 15px;
  }
  .radio-group {
    display: flex;
    gap: 30px;
  }
  .radio-option {
    display: flex;
    align-items: center;
    gap: 8px;
    cursor: pointer;
  }
  .radio-option input[type="radio"] {
    width: 18px;
    height: 18px;
    cursor: pointer;
  }
  .radio-option label {
    font-size: 15px;
    cursor: pointer;
  }
  .dimension-table-container {
    margin-bottom: 30px;
  }
  .dimension-header {
    background: linear-gradient(135deg, var(--primary-color) 0%, var(--primary-dark) 100%);
    color: white;
    padding: 15px 20px;
    border-radius: 10px 10px 0 0;
    font-size: 18px;
    font-weight: 600;
  }
  .dimension-table {
    width: 100%;
    background: white;
    border-radius: 0 0 10px 10px;
    overflow: hidden;
    box-shadow: 0 4px 15px rgba(0,0,0,0.1);
  }
  .dimension-table table {
    width: 100%;
    border-collapse: collapse;
  }
  .dimension-table th {
    background: #f8f9fa;
    padding: 12px;
    text-align: center;
    font-size: 14px;
    color: #666;
    border-bottom: 2px solid #e0e0e0;
  }
  .dimension-table td {
    padding: 12px;
    text-align: center;
    border-bottom: 1px solid #f0f0f0;
  }
  .dimension-table td:first-child {
    font-weight: 600;
    color: var(--primary-color);
  }
  .dimension-table input[type="number"] {
    width: 80px;
    padding: 8px;
    border: 2px solid #e0e0e0;
    border-radius: 6px;
    text-align: center;
    font-size: 14px;
  }
  .dimension-table input[type="number"]:focus {
    outline: none;
    border-color: var(--primary-color);
  }
  .dimension-table .total-col {
    background: #f8f9fa;
    font-weight: 600;
  }
  .maturity-input-container {
    background: white;
    padding: 15px 20px;
    border-radius: 0 0 10px 10px;
    border-top: 2px solid #e0e0e0;
    display: flex;
    align-items: center;
    gap: 15px;
    font-size: 14px;
  }
  .maturity-input-container label {
    font-weight: 600;
    color: #333;
  }
  .maturity-input-container input {
    width: 100px;
    padding: 8px 12px;
    border: 2px solid var(--primary-color);
    border-radius: 6px;
    text-align: center;
    font-size: 14px;
    font-weight: 600;
  }
  .maturity-input-container button {
    padding: 8px 16px;
    background: var(--primary-color);
    color: white;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    font-size: 13px;
    font-weight: 600;
    transition: background 0.3s;
  }
  .maturity-input-container button:hover {
    background: var(--primary-dark);
  }
  .maturity-input-container .hint {
    color: #999;
    font-size: 12px;
    font-style: italic;
  }
  .generate-btn {
    background: linear-gradient(135deg, var(--primary-color) 0%, var(--primary-dark) 100%);
    color: white;
    border: none;
    padding: 15px 40px;
    font-size: 18px;
    border-radius: 10px;
    cursor: pointer;
    display: block;
    margin: 0 auto;
    transition: transform 0.3s ease, box-shadow 0.3s ease;
    font-weight: 600;
  }
  .generate-btn:hover {
    transform: translateY(-3px);
    box-shadow: 0 10px 25px rgba(102,126,234,0.4);
  }
  .results-section {
    margin-top: 40px;
    display: none;
  }
  .maturity-level {
    background: linear-gradient(135deg, var(--theme-color) 0%, var(--theme-color)dd 100%);
    color: white;
    padding: 30px;
    border-radius: 15px;
    text-align: center;
    margin-bottom: 40px;
    box-shadow: 0 8px 20px rgba(0,0,0,0.15);
  }
  .maturity-level h3 {
    font-size: 18px;
    margin-bottom: 15px;
    opacity: 0.9;
  }
  .maturity-level .level {
    font-size: 56px;
    font-weight: bold;
    margin-bottom: 10px;
  }
  .maturity-level .description {
    font-size: 16px;
    line-height: 1.6;
  }
  .summary-cards {
    display: grid;
    grid-template-columns: repeat(5, 1fr);
    gap: 20px;
    margin-bottom: 40px;
  }
  .summary-card {
    background: linear-gradient(135deg, var(--primary-color) 0%, var(--primary-dark) 100%);
    color: white;
    padding: 25px;
    border-radius: 15px;
    text-align: center;
    box-shadow: 0 8px 20px rgba(0,0,0,0.15);
    display: flex;
    flex-direction: column;
    justify-content: center;
  }
  .summary-card .value {
    font-size: 42px;
    font-weight: bold;
    margin-bottom: 8px;
    order: 1;
  }
  .summary-card h3 {
    font-size: 13px;
    opacity: 0.9;
    order: 2;
  }
  .charts-container {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 30px;
    margin-bottom: 40px;
  }
  .chart-card {
    background: white;
    padding: 25px;
    border-radius: 15px;
    box-shadow: 0 4px 15px rgba(0,0,0,0.1);
  }
  .chart-card.full-width {
    grid-column: 1 / -1;
  }
  .chart-card h3 {
    color: #333;
    margin-bottom: 20px;
    font-size: 20px;
    text-align: center;
    font-weight: 600;
  }
  .heatmap-container {
    overflow-x: auto;
  }
  .heatmap {
    width: 100%;
    border-collapse: collapse;
    margin-top: 10px;
  }
  .heatmap th, .heatmap td {
    padding: 15px;
    text-align: center;
    border: 1px solid #e0e0e0;
    font-size: 14px;
  }
  .heatmap th {
    background: linear-gradient(135deg, var(--primary-color) 0%, var(--primary-dark) 100%);
    color: white;
    font-weight: 600;
  }
  .heatmap td:first-child {
    background: #f8f9fa;
    font-weight: 600;
    color: var(--primary-color);
  }
  .heat-cell {
    position: relative;
    font-weight: 600;
    border-radius: 6px;
  }
  .heat-excellent { background: #51cf66; color: white; }
  .heat-good { background: #74c0fc; color: white; }
  .heat-medium { background: #ffd43b; color: #333; }
  .heat-low { background: #ffa94d; color: white; }
  .heat-poor { background: #ff6b6b; color: white; }
  .dimension-scores-table {
    background: white;
    border-radius: 15px;
    padding: 25px;
    box-shadow: 0 4px 15px rgba(0,0,0,0.1);
    overflow-x: auto;
  }
  .dimension-scores-table h3 {
    color: #333;
    margin-bottom: 20px;
    font-size: 20px;
  }
  .scores-table {
    width: 100%;
    border-collapse: collapse;
  }
  .scores-table th, .scores-table td {
    padding: 12px;
    text-align: center;
    border-bottom: 1px solid #e0e0e0;
  }
  .scores-table th {
    background: linear-gradient(135deg, var(--primary-color) 0%, var(--primary-dark) 100%);
    color: white;
    font-weight: 600;
  }
  .scores-table tr:hover {
    background-color: #f8f9fa;
  }
  .score-badge {
    display: inline-block;
    padding: 6px 12px;
    border-radius: 15px;
    font-weight: 600;
    font-size: 14px;
  }
  .insights-section {
    background: white;
    border-radius: 15px;
    padding: 25px;
    box-shadow: 0 4px 15px rgba(0,0,0,0.1);
    margin-bottom: 40px;
  }
  .insights-section h3 {
    color: #333;
    margin-bottom: 20px;
    font-size: 20px;
  }
  .insight-item {
    padding: 15px;
    margin-bottom: 15px;
    border-radius: 10px;
    border-left: 4px solid;
  }
  .insight-strength {
    background: #e7f5ff;
    border-color: #74c0fc;
  }
  .insight-weakness {
    background: #fff5f5;
    border-color: #ff6b6b;
  }
  .insight-item h4 {
    margin-bottom: 8px;
    font-size: 16px;
  }
  .insight-item p {
    color: #666;
    line-height: 1.6;
  }
  @media (max-width: 1200px) {
    .charts-container {
      grid-template-columns: 1fr;
    }
    .summary-cards {
      grid-template-columns: repeat(3, 1fr);
    }
  }
  @media (max-width: 768px) {
    .summary-cards {
      grid-template-columns: repeat(2, 1fr);
    }
    .color-picker-container {
      position: static;
      margin-top: 20px;
    }
  }
</style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>ä¿¡æ¯å®‰å…¨èƒ½åŠ›æˆç†Ÿåº¦è¯„ä¼°ç³»ç»Ÿ</h1>
      <p>åŸºäºCMMIçš„äº”çº§æˆç†Ÿåº¦æ¨¡å‹ - å…¨é¢è¯Šæ–­ç»„ç»‡å®‰å…¨èƒ½åŠ›</p>
      <div class="mode-badge">ğŸ” è¯Šæ–­æ¨¡å¼ - é€‚ç”¨äºå®‰å…¨å’¨è¯¢ä¸èƒ½åŠ›æ‘¸åº•</div>
      <div class="color-picker-container">
        <label>è‡ªå®šä¹‰ä¸»é¢˜è‰²</label>
        <div class="color-input-group">
          <input type="color" id="themeColorPicker" value="#667eea" />
          <input type="text" id="themeColorText" value="#667eea" maxlength="7" />
        </div>
      </div>
    </div>
    <div class="content">
      <div class="input-section">
        <h2>ğŸ“Š æˆç†Ÿåº¦è¯„ä¼°æ•°æ®è¾“å…¥</h2>
        
        <div class="calculation-mode">
          <h3>è®¡ç®—æ¨¡å¼é€‰æ‹©</h3>
          <div class="radio-group">
            <div class="radio-option">
              <input type="radio" id="mode-weighted" name="calcMode" value="weighted" checked />
              <label for="mode-weighted">åŠ æƒå¹³å‡æ¨¡å¼ï¼ˆæ¨èï¼‰- ç»¼åˆè€ƒè™‘å„çº§åˆ«èƒ½åŠ›</label>
            </div>
            <div class="radio-option">
              <input type="radio" id="mode-barrel" name="calcMode" value="barrel" />
              <label for="mode-barrel">æœ¨æ¡¶åŸåˆ™æ¨¡å¼ - ä»¥æœ€å¼±ç»´åº¦ä¸ºå‡†</label>
            </div>
          </div>
        </div>

        <div class="dimension-table-container">
          <div class="dimension-header">ğŸ›¡ï¸ å®‰å…¨ç®¡ç†</div>
          <div class="dimension-table">
            <table>
              <thead>
                <tr>
                  <th>æˆç†Ÿåº¦çº§åˆ«</th>
                  <th>è¦æ±‚æ€»æ•°</th>
                  <th>å·²å®Œæˆ</th>
                  <th>éƒ¨åˆ†å®Œæˆ</th>
                  <th>æœªå®Œæˆ</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>1çº§ - éæ­£å¼æ‰§è¡Œçº§</td>
                  <td class="total-col">10</td>
                  <td><input type="number" id="mgmt-1-full" min="0" max="10" value="0" /></td>
                  <td><input type="number" id="mgmt-1-partial" min="0" max="10" value="0" /></td>
                  <td><input type="number" id="mgmt-1-none" min="0" max="10" value="10" /></td>
                </tr>
                <tr>
                  <td>2çº§ - è®¡åˆ’è·Ÿè¸ªçº§</td>
                  <td class="total-col">12</td>
                  <td><input type="number" id="mgmt-2-full" min="0" max="12" value="0" /></td>
                  <td><input type="number" id="mgmt-2-partial" min="0" max="12" value="0" /></td>
                  <td><input type="number" id="mgmt-2-none" min="0" max="12" value="12" /></td>
                </tr>
                <tr>
                  <td>3çº§ - å……åˆ†å®šä¹‰çº§</td>
                  <td class="total-col">15</td>
                  <td><input type="number" id="mgmt-3-full" min="0" max="15" value="0" /></td>
                  <td><input type="number" id="mgmt-3-partial" min="0" max="15" value="0" /></td>
                  <td><input type="number" id="mgmt-3-none" min="0" max="15" value="15" /></td>
                </tr>
                <tr>
                  <td>4çº§ - é‡åŒ–æ§åˆ¶çº§</td>
                  <td class="total-col">10</td>
                  <td><input type="number" id="mgmt-4-full" min="0" max="10" value="0" /></td>
                  <td><input type="number" id="mgmt-4-partial" min="0" max="10" value="0" /></td>
                  <td><input type="number" id="mgmt-4-none" min="0" max="10" value="10" /></td>
                </tr>
                <tr>
                  <td>5çº§ - æŒç»­ä¼˜åŒ–çº§</td>
                  <td class="total-col">8</td>
                  <td><input type="number" id="mgmt-5-full" min="0" max="8" value="0" /></td>
                  <td><input type="number" id="mgmt-5-partial" min="0" max="8" value="0" /></td>
                  <td><input type="number" id="mgmt-5-none" min="0" max="8" value="8" /></td>
                </tr>
              </tbody>
            </table>
          </div>
          <div class="maturity-input-container">
            <label>ğŸ’¡ å¿«é€Ÿè®¾ç½®æˆç†Ÿåº¦ï¼š</label>
            <input type="number" id="mgmt-maturity-input" min="1" max="5" step="0.1" placeholder="1.0 - 5.0" />
            <button onclick="setDimensionMaturity('mgmt')">åº”ç”¨</button>
            <span class="hint">(è¾“å…¥1-5ä¹‹é—´çš„æˆç†Ÿåº¦ç­‰çº§ï¼Œç³»ç»Ÿå°†è‡ªåŠ¨è®¡ç®—å„çº§åˆ«å®Œæˆåº¦)</span>
          </div>
        </div>

        <div class="dimension-table-container">
          <div class="dimension-header">ğŸ”§ å®‰å…¨æŠ€æœ¯</div>
          <div class="dimension-table">
            <table>
              <thead>
                <tr>
                  <th>æˆç†Ÿåº¦çº§åˆ«</th>
                  <th>è¦æ±‚æ€»æ•°</th>
                  <th>å·²å®Œæˆ</th>
                  <th>éƒ¨åˆ†å®Œæˆ</th>
                  <th>æœªå®Œæˆ</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>1çº§ - éæ­£å¼æ‰§è¡Œçº§</td>
                  <td class="total-col">12</td>
                  <td><input type="number" id="tech-1-full" min="0" max="12" value="0" /></td>
                  <td><input type="number" id="tech-1-partial" min="0" max="12" value="0" /></td>
                  <td><input type="number" id="tech-1-none" min="0" max="12" value="12" /></td>
                </tr>
                <tr>
                  <td>2çº§ - è®¡åˆ’è·Ÿè¸ªçº§</td>
                  <td class="total-col">15</td>
                  <td><input type="number" id="tech-2-full" min="0" max="15" value="0" /></td>
                  <td><input type="number" id="tech-2-partial" min="0" max="15" value="0" /></td>
                  <td><input type="number" id="tech-2-none" min="0" max="15" value="15" /></td>
                </tr>
                <tr>
                  <td>3çº§ - å……åˆ†å®šä¹‰çº§</td>
                  <td class="total-col">18</td>
                  <td><input type="number" id="tech-3-full" min="0" max="18" value="0" /></td>
                  <td><input type="number" id="tech-3-partial" min="0" max="18" value="0" /></td>
                  <td><input type="number" id="tech-3-none" min="0" max="18" value="18" /></td>
                </tr>
                <tr>
                  <td>4çº§ - é‡åŒ–æ§åˆ¶çº§</td>
                  <td class="total-col">12</td>
                  <td><input type="number" id="tech-4-full" min="0" max="12" value="0" /></td>
                  <td><input type="number" id="tech-4-partial" min="0" max="12" value="0" /></td>
                  <td><input type="number" id="tech-4-none" min="0" max="12" value="12" /></td>
                </tr>
                <tr>
                  <td>5çº§ - æŒç»­ä¼˜åŒ–çº§</td>
                  <td class="total-col">10</td>
                  <td><input type="number" id="tech-5-full" min="0" max="10" value="0" /></td>
                  <td><input type="number" id="tech-5-partial" min="0" max="10" value="0" /></td>
                  <td><input type="number" id="tech-5-none" min="0" max="10" value="10" /></td>
                </tr>
              </tbody>
            </table>
          </div>
          <div class="maturity-input-container">
            <label>ğŸ’¡ å¿«é€Ÿè®¾ç½®æˆç†Ÿåº¦ï¼š</label>
            <input type="number" id="tech-maturity-input" min="1" max="5" step="0.1" placeholder="1.0 - 5.0" />
            <button onclick="setDimensionMaturity('tech')">åº”ç”¨</button>
            <span class="hint">(è¾“å…¥1-5ä¹‹é—´çš„æˆç†Ÿåº¦ç­‰çº§ï¼Œç³»ç»Ÿå°†è‡ªåŠ¨è®¡ç®—å„çº§åˆ«å®Œæˆåº¦)</span>
          </div>
        </div>

        <div class="dimension-table-container">
          <div class="dimension-header">âš™ï¸ å®‰å…¨è¿è¥</div>
          <div class="dimension-table">
            <table>
              <thead>
                <tr>
                  <th>æˆç†Ÿåº¦çº§åˆ«</th>
                  <th>è¦æ±‚æ€»æ•°</th>
                  <th>å·²å®Œæˆ</th>
                  <th>éƒ¨åˆ†å®Œæˆ</th>
                  <th>æœªå®Œæˆ</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>1çº§ - éæ­£å¼æ‰§è¡Œçº§</td>
                  <td class="total-col">11</td>
                  <td><input type="number" id="ops-1-full" min="0" max="11" value="0" /></td>
                  <td><input type="number" id="ops-1-partial" min="0" max="11" value="0" /></td>
                  <td><input type="number" id="ops-1-none" min="0" max="11" value="11" /></td>
                </tr>
                <tr>
                  <td>2çº§ - è®¡åˆ’è·Ÿè¸ªçº§</td>
                  <td class="total-col">14</td>
                  <td><input type="number" id="ops-2-full" min="0" max="14" value="0" /></td>
                  <td><input type="number" id="ops-2-partial" min="0" max="14" value="0" /></td>
                  <td><input type="number" id="ops-2-none" min="0" max="14" value="14" /></td>
                </tr>
                <tr>
                  <td>3çº§ - å……åˆ†å®šä¹‰çº§</td>
                  <td class="total-col">16</td>
                  <td><input type="number" id="ops-3-full" min="0" max="16" value="0" /></td>
                  <td><input type="number" id="ops-3-partial" min="0" max="16" value="0" /></td>
                  <td><input type="number" id="ops-3-none" min="0" max="16" value="16" /></td>
                </tr>
                <tr>
                  <td>4çº§ - é‡åŒ–æ§åˆ¶çº§</td>
                  <td class="total-col">11</td>
                  <td><input type="number" id="ops-4-full" min="0" max="11" value="0" /></td>
                  <td><input type="number" id="ops-4-partial" min="0" max="11" value="0" /></td>
                  <td><input type="number" id="ops-4-none" min="0" max="11" value="11" /></td>
                </tr>
                <tr>
                  <td>5çº§ - æŒç»­ä¼˜åŒ–çº§</td>
                  <td class="total-col">9</td>
                  <td><input type="number" id="ops-5-full" min="0" max="9" value="0" /></td>
                  <td><input type="number" id="ops-5-partial" min="0" max="9" value="0" /></td>
                  <td><input type="number" id="ops-5-none" min="0" max="9" value="9" /></td>
                </tr>
              </tbody>
            </table>
          </div>
          <div class="maturity-input-container">
            <label>ğŸ’¡ å¿«é€Ÿè®¾ç½®æˆç†Ÿåº¦ï¼š</label>
            <input type="number" id="ops-maturity-input" min="1" max="5" step="0.1" placeholder="1.0 - 5.0" />
            <button onclick="setDimensionMaturity('ops')">åº”ç”¨</button>
            <span class="hint">(è¾“å…¥1-5ä¹‹é—´çš„æˆç†Ÿåº¦ç­‰çº§ï¼Œç³»ç»Ÿå°†è‡ªåŠ¨è®¡ç®—å„çº§åˆ«å®Œæˆåº¦)</span>
          </div>
        </div>

        <div class="dimension-table-container">
          <div class="dimension-header">ğŸ’» å¼€å‘å®‰å…¨</div>
          <div class="dimension-table">
            <table>
              <thead>
                <tr>
                  <th>æˆç†Ÿåº¦çº§åˆ«</th>
                  <th>è¦æ±‚æ€»æ•°</th>
                  <th>å·²å®Œæˆ</th>
                  <th>éƒ¨åˆ†å®Œæˆ</th>
                  <th>æœªå®Œæˆ</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>1çº§ - éæ­£å¼æ‰§è¡Œçº§</td>
                  <td class="total-col">9</td>
                  <td><input type="number" id="dev-1-full" min="0" max="9" value="0" /></td>
                  <td><input type="number" id="dev-1-partial" min="0" max="9" value="0" /></td>
                  <td><input type="number" id="dev-1-none" min="0" max="9" value="9" /></td>
                </tr>
                <tr>
                  <td>2çº§ - è®¡åˆ’è·Ÿè¸ªçº§</td>
                  <td class="total-col">13</td>
                  <td><input type="number" id="dev-2-full" min="0" max="13" value="0" /></td>
                  <td><input type="number" id="dev-2-partial" min="0" max="13" value="0" /></td>
                  <td><input type="number" id="dev-2-none" min="0" max="13" value="13" /></td>
                </tr>
                <tr>
                  <td>3çº§ - å……åˆ†å®šä¹‰çº§</td>
                  <td class="total-col">17</td>
                  <td><input type="number" id="dev-3-full" min="0" max="17" value="0" /></td>
                  <td><input type="number" id="dev-3-partial" min="0" max="17" value="0" /></td>
                  <td><input type="number" id="dev-3-none" min="0" max="17" value="17" /></td>
                </tr>
                <tr>
                  <td>4çº§ - é‡åŒ–æ§åˆ¶çº§</td>
                  <td class="total-col">12</td>
                  <td><input type="number" id="dev-4-full" min="0" max="12" value="0" /></td>
                  <td><input type="number" id="dev-4-partial" min="0" max="12" value="0" /></td>
                  <td><input type="number" id="dev-4-none" min="0" max="12" value="12" /></td>
                </tr>
                <tr>
                  <td>5çº§ - æŒç»­ä¼˜åŒ–çº§</td>
                  <td class="total-col">10</td>
                  <td><input type="number" id="dev-5-full" min="0" max="10" value="0" /></td>
                  <td><input type="number" id="dev-5-partial" min="0" max="10" value="0" /></td>
                  <td><input type="number" id="dev-5-none" min="0" max="10" value="10" /></td>
                </tr>
              </tbody>
            </table>
          </div>
          <div class="maturity-input-container">
            <label>ğŸ’¡ å¿«é€Ÿè®¾ç½®æˆç†Ÿåº¦ï¼š</label>
            <input type="number" id="dev-maturity-input" min="1" max="5" step="0.1" placeholder="1.0 - 5.0" />
            <button onclick="setDimensionMaturity('dev')">åº”ç”¨</button>
            <span class="hint">(è¾“å…¥1-5ä¹‹é—´çš„æˆç†Ÿåº¦ç­‰çº§ï¼Œç³»ç»Ÿå°†è‡ªåŠ¨è®¡ç®—å„çº§åˆ«å®Œæˆåº¦)</span>
          </div>
        </div>

        <div class="dimension-table-container">
          <div class="dimension-header">ğŸ” æ•°æ®å®‰å…¨</div>
          <div class="dimension-table">
            <table>
              <thead>
                <tr>
                  <th>æˆç†Ÿåº¦çº§åˆ«</th>
                  <th>è¦æ±‚æ€»æ•°</th>
                  <th>å·²å®Œæˆ</th>
                  <th>éƒ¨åˆ†å®Œæˆ</th>
                  <th>æœªå®Œæˆ</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>1çº§ - éæ­£å¼æ‰§è¡Œçº§</td>
                  <td class="total-col">10</td>
                  <td><input type="number" id="data-1-full" min="0" max="10" value="0" /></td>
                  <td><input type="number" id="data-1-partial" min="0" max="10" value="0" /></td>
                  <td><input type="number" id="data-1-none" min="0" max="10" value="10" /></td>
                </tr>
                <tr>
                  <td>2çº§ - è®¡åˆ’è·Ÿè¸ªçº§</td>
                  <td class="total-col">13</td>
                  <td><input type="number" id="data-2-full" min="0" max="13" value="0" /></td>
                  <td><input type="number" id="data-2-partial" min="0" max="13" value="0" /></td>
                  <td><input type="number" id="data-2-none" min="0" max="13" value="13" /></td>
                </tr>
                <tr>
                  <td>3çº§ - å……åˆ†å®šä¹‰çº§</td>
                  <td class="total-col">16</td>
                  <td><input type="number" id="data-3-full" min="0" max="16" value="0" /></td>
                  <td><input type="number" id="data-3-partial" min="0" max="16" value="0" /></td>
                  <td><input type="number" id="data-3-none" min="0" max="16" value="16" /></td>
                </tr>
                <tr>
                  <td>4çº§ - é‡åŒ–æ§åˆ¶çº§</td>
                  <td class="total-col">11</td>
                  <td><input type="number" id="data-4-full" min="0" max="11" value="0" /></td>
                  <td><input type="number" id="data-4-partial" min="0" max="11" value="0" /></td>
                  <td><input type="number" id="data-4-none" min="0" max="11" value="11" /></td>
                </tr>
                <tr>
                  <td>5çº§ - æŒç»­ä¼˜åŒ–çº§</td>
                  <td class="total-col">9</td>
                  <td><input type="number" id="data-5-full" min="0" max="9" value="0" /></td>
                  <td><input type="number" id="data-5-partial" min="0" max="9" value="0" /></td>
                  <td><input type="number" id="data-5-none" min="0" max="9" value="9" /></td>
                </tr>
              </tbody>
            </table>
          </div>
          <div class="maturity-input-container">
            <label>ğŸ’¡ å¿«é€Ÿè®¾ç½®æˆç†Ÿåº¦ï¼š</label>
            <input type="number" id="data-maturity-input" min="1" max="5" step="0.1" placeholder="1.0 - 5.0" />
            <button onclick="setDimensionMaturity('data')">åº”ç”¨</button>
            <span class="hint">(è¾“å…¥1-5ä¹‹é—´çš„æˆç†Ÿåº¦ç­‰çº§ï¼Œç³»ç»Ÿå°†è‡ªåŠ¨è®¡ç®—å„çº§åˆ«å®Œæˆåº¦)</span>
          </div>
        </div>

        <button class="generate-btn" onclick="generateReport()">ğŸš€ ç”Ÿæˆæˆç†Ÿåº¦è¯Šæ–­æŠ¥å‘Š</button>
      </div>

      <div class="results-section" id="results">
        <div class="maturity-level" id="maturityLevel">
          <h3>æ•´ä½“æˆç†Ÿåº¦ç­‰çº§</h3>
          <div class="level" id="levelValue">-</div>
          <div class="description" id="levelDescription">-</div>
        </div>

        <div class="summary-cards">
          <div class="summary-card">
            <div class="value" id="avgMaturity">0.0</div>
            <h3>å¹³å‡æˆç†Ÿåº¦</h3>
          </div>
          <div class="summary-card">
            <div class="value" id="totalRequirements">0</div>
            <h3>è¯„ä¼°è¦æ±‚æ€»æ•°</h3>
          </div>
          <div class="summary-card">
            <div class="value" id="fullyCompleted">0</div>
            <h3>å·²å®Œæˆé¡¹</h3>
          </div>
          <div class="summary-card">
            <div class="value" id="partiallyCompleted">0</div>
            <h3>éƒ¨åˆ†å®Œæˆé¡¹</h3>
          </div>
          <div class="summary-card">
            <div class="value" id="overallCompletion">0%</div>
            <h3>æ•´ä½“å®Œæˆåº¦</h3>
          </div>
        </div>

        <div class="insights-section">
          <h3>ğŸ’¡ å…³é”®æ´å¯Ÿä¸å»ºè®®</h3>
          <div id="insightsContainer"></div>
        </div>

        <div class="chart-card full-width">
          <h3>ğŸ”¥ æˆç†Ÿåº¦çƒ­åŠ›å›¾ - å„ç»´åº¦å„çº§åˆ«è¾¾æˆæƒ…å†µ</h3>
          <div class="heatmap-container">
            <table class="heatmap" id="heatmapTable">
              <thead>
                <tr>
                  <th>ç»´åº¦ / çº§åˆ«</th>
                  <th>1çº§</th>
                  <th>2çº§</th>
                  <th>3çº§</th>
                  <th>4çº§</th>
                  <th>5çº§</th>
                </tr>
              </thead>
              <tbody id="heatmapBody"></tbody>
            </table>
          </div>
        </div>

        <div class="charts-container">
          <div class="chart-card">
            <h3>æ•´ä½“æˆç†Ÿåº¦ä»ªè¡¨ç›˜</h3>
            <canvas id="gaugeChart"></canvas>
          </div>
          <div class="chart-card">
            <h3>äº”ç»´èƒ½åŠ›é›·è¾¾å›¾</h3>
            <canvas id="radarChart"></canvas>
          </div>
          <div class="chart-card">
            <h3>å„ç»´åº¦æˆç†Ÿåº¦å¯¹æ¯”</h3>
            <canvas id="barChart"></canvas>
          </div>
          <div class="chart-card">
            <h3>æˆç†Ÿåº¦åˆ†å¸ƒå †å å›¾</h3>
            <canvas id="stackedChart"></canvas>
          </div>
        </div>

        <div class="dimension-scores-table">
          <h3>ğŸ“‹ å„ç»´åº¦è¯¦ç»†æˆç†Ÿåº¦è¯„åˆ†</h3>
          <table class="scores-table" id="scoresTable">
            <thead>
              <tr>
                <th>è¯„ä¼°ç»´åº¦</th>
                <th>1çº§å¾—åˆ†</th>
                <th>2çº§å¾—åˆ†</th>
                <th>3çº§å¾—åˆ†</th>
                <th>4çº§å¾—åˆ†</th>
                <th>5çº§å¾—åˆ†</th>
                <th>ç»¼åˆæˆç†Ÿåº¦</th>
              </tr>
            </thead>
            <tbody id="scoresTableBody"></tbody>
          </table>
        </div>
      </div>
    </div>
  </div>

<script>
  const colorPicker = document.getElementById('themeColorPicker');
  const colorText = document.getElementById('themeColorText');

  colorPicker.addEventListener('input', e => {
    colorText.value = e.target.value;
    updateThemeColor(e.target.value);
  });
  
  colorText.addEventListener('input', e => {
    if (/^#[0-9A-F]{6}$/i.test(e.target.value)) {
      colorPicker.value = e.target.value;
      updateThemeColor(e.target.value);
    }
  });

  function updateThemeColor(color) {
    const darkColor = adjustColor(color, -20);
    document.documentElement.style.setProperty('--primary-color', color);
    document.documentElement.style.setProperty('--primary-dark', darkColor);
    document.documentElement.style.setProperty('--theme-color', color);
    if (document.getElementById('results').style.display === 'block') {
      generateReport();
    }
  }

  function adjustColor(color, percent) {
    const num = parseInt(color.replace("#", ""), 16);
    const amt = Math.round(2.55 * percent);
    const R = (num >> 16) + amt;
    const G = (num >> 8 & 0x00FF) + amt;
    const B = (num & 0x0000FF) + amt;
    return "#" + (0x1000000 +
      (R < 255 ? R < 1 ? 0 : R : 255) * 0x10000 +
      (G < 255 ? G < 1 ? 0 : G : 255) * 0x100 +
      (B < 255 ? B < 1 ? 0 : B : 255))
      .toString(16).slice(1);
  }

  const dimensionConfig = {
    mgmt: { name: 'å®‰å…¨ç®¡ç†', levels: [10, 12, 15, 10, 8] },
    tech: { name: 'å®‰å…¨æŠ€æœ¯', levels: [12, 15, 18, 12, 10] },
    ops: { name: 'å®‰å…¨è¿è¥', levels: [11, 14, 16, 11, 9] },
    dev: { name: 'å¼€å‘å®‰å…¨', levels: [9, 13, 17, 12, 10] },
    data: { name: 'æ•°æ®å®‰å…¨', levels: [10, 13, 16, 11, 9] }
  };

  let charts = {};

  // æ·»åŠ è‡ªåŠ¨è®¡ç®—æœªå®Œæˆé¡¹çš„åŠŸèƒ½
  document.querySelectorAll('input[type="number"]').forEach(input => {
    input.addEventListener('input', function() {
      const id = this.id;
      const match = id.match(/(.+)-(\d)-(\w+)/);
      if (!match) return;
      
      const [, dimension, level, type] = match;
      if (type !== 'none') {
        const total = dimensionConfig[dimension].levels[level - 1];
        const fullInput = document.getElementById(`${dimension}-${level}-full`);
        const partialInput = document.getElementById(`${dimension}-${level}-partial`);
        const noneInput = document.getElementById(`${dimension}-${level}-none`);
        
        const full = parseInt(fullInput.value) || 0;
        const partial = parseInt(partialInput.value) || 0;
        const remaining = total - full - partial;
        
        if (remaining >= 0) {
          noneInput.value = remaining;
        }
      }
    });
  });

  function setDimensionMaturity(dimension) {
    const inputId = `${dimension}-maturity-input`;
    const targetMaturity = parseFloat(document.getElementById(inputId).value);
    
    if (!targetMaturity || targetMaturity < 1 || targetMaturity > 5) {
      alert('è¯·è¾“å…¥1åˆ°5ä¹‹é—´çš„æˆç†Ÿåº¦ç­‰çº§ï¼');
      return;
    }
    
    const config = dimensionConfig[dimension];
    const targetLevel = Math.floor(targetMaturity);
    const levelProgress = targetMaturity - targetLevel;
    
    for (let level = 1; level <= 5; level++) {
      const total = config.levels[level - 1];
      let full, partial;
      
      if (level < targetLevel) {
        full = total;
        partial = 0;
      } else if (level === targetLevel) {
        full = Math.floor(total * levelProgress);
        partial = Math.ceil((total * levelProgress - full) * 2);
        if (full + partial > total) partial = total - full;
      } else {
        full = 0;
        partial = 0;
      }
      
      const none = total - full - partial;
      
      document.getElementById(`${dimension}-${level}-full`).value = full;
      document.getElementById(`${dimension}-${level}-partial`).value = partial;
      document.getElementById(`${dimension}-${level}-none`).value = none;
    }
    
    document.getElementById(inputId).value = '';
    alert(`${config.name}çš„æˆç†Ÿåº¦å·²è®¾ç½®ä¸º ${targetMaturity} çº§ï¼`);
  }

  function validateInputs() {
    for (const [key, config] of Object.entries(dimensionConfig)) {
      for (let level = 1; level <= 5; level++) {
        const total = config.levels[level - 1];
        const full = parseInt(document.getElementById(`${key}-${level}-full`).value) || 0;
        const partial = parseInt(document.getElementById(`${key}-${level}-partial`).value) || 0;
        const none = parseInt(document.getElementById(`${key}-${level}-none`).value) || 0;
        
        if (full + partial + none !== total) {
          alert(`${config.name} ${level}çº§ï¼šå·²å®Œæˆ(${full}) + éƒ¨åˆ†å®Œæˆ(${partial}) + æœªå®Œæˆ(${none}) ä¸ç­‰äºæ€»æ•°(${total})ï¼Œè¯·æ£€æŸ¥ï¼`);
          return false;
        }
        
        if (full < 0 || partial < 0 || none < 0) {
          alert(`${config.name} ${level}çº§ï¼šæ•°å€¼ä¸èƒ½ä¸ºè´Ÿæ•°ï¼`);
          return false;
        }
      }
    }
    return true;
  }

  function calculateDimensionMaturity(dimension) {
    let levelScores = [];
    let totalWeight = 0;
    let weightedSum = 0;
    
    for (let level = 1; level <= 5; level++) {
      const total = dimensionConfig[dimension].levels[level - 1];
      const full = parseInt(document.getElementById(`${dimension}-${level}-full`).value) || 0;
      const partial = parseInt(document.getElementById(`${dimension}-${level}-partial`).value) || 0;
      
      // å·²å®Œæˆè®¡100%ï¼Œéƒ¨åˆ†å®Œæˆè®¡50%
      const score = ((full * 1.0 + partial * 0.5) / total) * 100;
      levelScores.push(score);
      
      // åŠ æƒè®¡ç®—ï¼šçº§åˆ«è¶Šé«˜æƒé‡è¶Šå¤§
      const weight = level;
      weightedSum += score * weight;
      totalWeight += weight;
    }
    
    // åŠ æƒå¹³å‡è½¬æ¢ä¸ºæˆç†Ÿåº¦ç­‰çº§ï¼ˆ1-5ï¼‰
    const weightedAvg = weightedSum / totalWeight;
    const maturity = (weightedAvg / 100) * 5;
    
    return {
      maturity: maturity,
      levelScores: levelScores
    };
  }

  function getMaturityColor(maturity) {
    if (maturity >= 4.5) return '#51cf66';
    if (maturity >= 3.5) return '#74c0fc';
    if (maturity >= 2.5) return '#ffd43b';
    if (maturity >= 1.5) return '#ffa94d';
    return '#ff6b6b';
  }

  function getHeatColor(score) {
    if (score >= 80) return 'heat-excellent';
    if (score >= 60) return 'heat-good';
    if (score >= 40) return 'heat-medium';
    if (score >= 20) return 'heat-low';
    return 'heat-poor';
  }

  function generateInsights(dimensionResults, overallMaturity) {
    const insights = [];
    
    // æ‰¾å‡ºæœ€å¼ºå’Œæœ€å¼±ç»´åº¦
    let strongest = { name: '', maturity: 0 };
    let weakest = { name: '', maturity: 999 };
    
    for (const [key, result] of Object.entries(dimensionResults)) {
      if (result.maturity > strongest.maturity) {
        strongest = { name: dimensionConfig[key].name, maturity: result.maturity };
      }
      if (result.maturity < weakest.maturity) {
        weakest = { name: dimensionConfig[key].name, maturity: result.maturity };
      }
    }
    
    insights.push({
      type: 'strength',
      title: `â­ ä¼˜åŠ¿é¢†åŸŸï¼š${strongest.name}`,
      content: `è¯¥ç»´åº¦æˆç†Ÿåº¦è¾¾åˆ° ${strongest.maturity.toFixed(2)} çº§ï¼Œè¡¨ç°ä¼˜ç§€ã€‚å»ºè®®ç»§ç»­ä¿æŒå¹¶ä½œä¸ºæœ€ä½³å®è·µå‘å…¶ä»–ç»´åº¦æ¨å¹¿ã€‚`
    });
    
    insights.push({
      type: 'weakness',
      title: `âš ï¸ æ”¹è¿›é‡ç‚¹ï¼š${weakest.name}`,
      content: `è¯¥ç»´åº¦æˆç†Ÿåº¦ä»…ä¸º ${weakest.maturity.toFixed(2)} çº§ï¼Œæ˜¯å½“å‰çŸ­æ¿ã€‚å»ºè®®ä¼˜å…ˆæŠ•å…¥èµ„æºè¿›è¡Œèƒ½åŠ›æå‡ï¼Œè¿™å°†æ˜¾è‘—æé«˜æ•´ä½“æˆç†Ÿåº¦ã€‚`
    });
    
    // å‘ç°é«˜çº§èƒ½åŠ›äº®ç‚¹
    for (const [key, result] of Object.entries(dimensionResults)) {
      if (result.levelScores[3] > 30 || result.levelScores[4] > 20) {
        insights.push({
          type: 'strength',
          title: `âœ¨ å‰ç»å¸ƒå±€ï¼š${dimensionConfig[key].name}`,
          content: `åœ¨é«˜çº§èƒ½åŠ›ï¼ˆ4-5çº§ï¼‰æ–¹é¢å·²æœ‰å»ºè®¾ï¼Œæ˜¾ç¤ºç»„ç»‡å…·å¤‡å‰ç»æ€§ã€‚å»ºè®®åœ¨å·©å›ºåŸºç¡€çš„åŒæ—¶ï¼Œç»§ç»­æ·±åŒ–è¿™äº›å…ˆè¿›å®è·µã€‚`
        });
        break;
      }
    }
    
    return insights;
  }

  function generateReport() {
    if (!validateInputs()) return;
    
    const calcMode = document.querySelector('input[name="calcMode"]:checked').value;
    const dimensionResults = {};
    
    let totalReq = 0, totalFull = 0, totalPartial = 0;
    
    // è®¡ç®—æ¯ä¸ªç»´åº¦çš„æˆç†Ÿåº¦
    for (const key of Object.keys(dimensionConfig)) {
      dimensionResults[key] = calculateDimensionMaturity(key);
      
      for (let level = 1; level <= 5; level++) {
        const total = dimensionConfig[key].levels[level - 1];
        totalReq += total;
        totalFull += parseInt(document.getElementById(`${key}-${level}-full`).value) || 0;
        totalPartial += parseInt(document.getElementById(`${key}-${level}-partial`).value) || 0;
      }
    }
    
    // è®¡ç®—æ•´ä½“æˆç†Ÿåº¦
    let overallMaturity;
    if (calcMode === 'barrel') {
      // æœ¨æ¡¶åŸåˆ™ï¼šå–æœ€å°å€¼
      overallMaturity = Math.min(...Object.values(dimensionResults).map(r => r.maturity));
    } else {
      // åŠ æƒå¹³å‡
      const sum = Object.values(dimensionResults).reduce((acc, r) => acc + r.maturity, 0);
      overallMaturity = sum / Object.keys(dimensionConfig).length;
    }
    
    const overallCompletion = ((totalFull + totalPartial * 0.5) / totalReq * 100).toFixed(1);
    
    // æ›´æ–°æ±‡æ€»å¡ç‰‡
    document.getElementById('avgMaturity').textContent = overallMaturity.toFixed(2);
    document.getElementById('totalRequirements').textContent = totalReq;
    document.getElementById('fullyCompleted').textContent = totalFull;
    document.getElementById('partiallyCompleted').textContent = totalPartial;
    document.getElementById('overallCompletion').textContent = overallCompletion + '%';
    
    // æ›´æ–°æ•´ä½“ç­‰çº§
    const levelDesc = getMaturityLevelDescription(overallMaturity);
    document.getElementById('levelValue').textContent = overallMaturity.toFixed(2) + ' çº§';
    document.getElementById('levelDescription').textContent = levelDesc;
    
    // ç”Ÿæˆæ´å¯Ÿ
    const insights = generateInsights(dimensionResults, overallMaturity);
    const insightsContainer = document.getElementById('insightsContainer');
    insightsContainer.innerHTML = insights.map(insight => `
      <div class="insight-item insight-${insight.type}">
        <h4>${insight.title}</h4>
        <p>${insight.content}</p>
      </div>
    `).join('');
    
    // ç”Ÿæˆçƒ­åŠ›å›¾
    generateHeatmap(dimensionResults);
    
    // ç”Ÿæˆè¯¦ç»†è¯„åˆ†è¡¨
    generateScoresTable(dimensionResults);
    
    // ç”Ÿæˆå›¾è¡¨
    generateCharts(dimensionResults, overallMaturity);
    
    document.getElementById('results').style.display = 'block';
    document.getElementById('results').scrollIntoView({ behavior: 'smooth' });
  }

  function getMaturityLevelDescription(maturity) {
    if (maturity >= 4.5) return 'æ¥è¿‘æŒç»­ä¼˜åŒ–çº§ - ç»„ç»‡å…·å¤‡å‰ç»æ€§ï¼Œèƒ½å¤ŸåŸºäºæ•°æ®æŒç»­æ”¹è¿›å®‰å…¨æµç¨‹';
    if (maturity >= 3.5) return 'æ¥è¿‘é‡åŒ–æ§åˆ¶çº§ - å®‰å…¨æµç¨‹æ‰§è¡Œè¢«é‡åŒ–ï¼Œå¹¶ä½¿ç”¨æ•°æ®è¿›è¡Œç›‘æ§';
    if (maturity >= 2.5) return 'æ¥è¿‘å……åˆ†å®šä¹‰çº§ - å®‰å…¨ç­–ç•¥å’Œæµç¨‹å·²ç»æ ‡å‡†åŒ–ã€æ–‡æ¡£åŒ–';
    if (maturity >= 1.5) return 'æ¥è¿‘è®¡åˆ’è·Ÿè¸ªçº§ - å®‰å…¨ç­–ç•¥å’Œæµç¨‹å¾—åˆ°åˆæ­¥å®šä¹‰';
    return 'éæ­£å¼æ‰§è¡Œçº§ - å®‰å…¨å·¥ä½œæ˜¯ä¸´æ—¶çš„ã€éšæ„çš„ï¼Œç¼ºä¹ç³»ç»Ÿæ€§';
  }

  function generateHeatmap(dimensionResults) {
    const tbody = document.getElementById('heatmapBody');
    tbody.innerHTML = '';
    
    for (const [key, result] of Object.entries(dimensionResults)) {
      const row = tbody.insertRow();
      row.innerHTML = `<td>${dimensionConfig[key].name}</td>`;
      
      for (let i = 0; i < 5; i++) {
        const score = result.levelScores[i];
        const cell = row.insertCell();
        cell.className = `heat-cell ${getHeatColor(score)}`;
        cell.textContent = score.toFixed(0) + '%';
      }
    }
  }

  function generateScoresTable(dimensionResults) {
    const tbody = document.getElementById('scoresTableBody');
    tbody.innerHTML = '';
    
    for (const [key, result] of Object.entries(dimensionResults)) {
      const row = tbody.insertRow();
      row.innerHTML = `
        <td><strong>${dimensionConfig[key].name}</strong></td>
        <td>${result.levelScores[0].toFixed(0)}%</td>
        <td>${result.levelScores[1].toFixed(0)}%</td>
        <td>${result.levelScores[2].toFixed(0)}%</td>
        <td>${result.levelScores[3].toFixed(0)}%</td>
        <td>${result.levelScores[4].toFixed(0)}%</td>
        <td><span class="score-badge" style="background: ${getMaturityColor(result.maturity)}; color: white;">${result.maturity.toFixed(2)}</span></td>
      `;
    }
  }

  function generateCharts(dimensionResults, overallMaturity) {
    const primaryColor = getComputedStyle(document.documentElement).getPropertyValue('--primary-color').trim();
    
    Object.values(charts).forEach(chart => chart && chart.destroy());
    charts = {};
    
    createGaugeChart(overallMaturity, primaryColor);
    createRadarChart(dimensionResults, primaryColor);
    createBarChart(dimensionResults);
    createStackedChart(dimensionResults);
  }

  function createGaugeChart(maturity, color) {
    const ctx = document.getElementById('gaugeChart').getContext('2d');
    const percentage = (maturity / 5) * 100;
    
    charts.gauge = new Chart(ctx, {
      type: 'doughnut',
      data: {
        datasets: [{
          data: [percentage, 100 - percentage],
          backgroundColor: [getMaturityColor(maturity), '#e0e0e0'],
          borderWidth: 0
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: true,
        rotation: -90,
        circumference: 180,
        cutout: '75%',
        plugins: { legend: { display: false }, tooltip: { enabled: false } }
      },
      plugins: [{
        afterDraw: (chart) => {
          const ctx = chart.ctx;
          const width = chart.width;
          const height = chart.height;
          ctx.restore();
          ctx.font = 'bold 32px Arial';
          ctx.textBaseline = 'middle';
          ctx.fillStyle = '#333';
          const text = maturity.toFixed(2);
          const textX = Math.round((width - ctx.measureText(text).width) / 2);
          const textY = height / 1.5;
          ctx.fillText(text, textX, textY);
          ctx.save();
        }
      }]
    });
  }

  function createRadarChart(dimensionResults, color) {
    const ctx = document.getElementById('radarChart').getContext('2d');
    const labels = Object.keys(dimensionConfig).map(key => dimensionConfig[key].name);
    const data = Object.values(dimensionResults).map(r => r.maturity);
    
    charts.radar = new Chart(ctx, {
      type: 'radar',
      data: {
        labels: labels,
        datasets: [{
          label: 'æˆç†Ÿåº¦ç­‰çº§',
          data: data,
          backgroundColor: hexToRgba(color, 0.2),
          borderColor: color,
          borderWidth: 3,
          pointBackgroundColor: color,
          pointRadius: 5
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: true,
        scales: {
          r: {
            beginAtZero: true,
            max: 5,
            ticks: {
              stepSize: 1,
              font: { size: 14, family: "'Microsoft YaHei', Arial, sans-serif" }
            },
            pointLabels: {
              font: { size: 16, weight: 'bold', family: "'Microsoft YaHei', Arial, sans-serif" }
            }
          }
        },
        plugins: { legend: { display: false } }
      }
    });
  }

  function createBarChart(dimensionResults) {
    const ctx = document.getElementById('barChart').getContext('2d');
    const labels = Object.keys(dimensionConfig).map(key => dimensionConfig[key].name);
    const data = Object.values(dimensionResults).map(r => r.maturity);
    
    charts.bar = new Chart(ctx, {
      type: 'bar',
      data: {
        labels: labels,
        datasets: [{
          label: 'æˆç†Ÿåº¦ç­‰çº§',
          data: data,
          backgroundColor: data.map(v => getMaturityColor(v)),
          borderColor: data.map(v => getMaturityColor(v)),
          borderWidth: 2
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: true,
        scales: {
          x: {
            ticks: {
              font: { size: 14, weight: 'bold', family: "'Microsoft YaHei', Arial, sans-serif" }
            }
          },
          y: {
            beginAtZero: true,
            max: 5,
            ticks: {
              stepSize: 1,
              font: { size: 13, family: "'Microsoft YaHei', Arial, sans-serif" }
            }
          }
        },
        plugins: { legend: { display: false } }
      }
    });
  }

  function createStackedChart(dimensionResults) {
    const ctx = document.getElementById('stackedChart').getContext('2d');
    const labels = Object.keys(dimensionConfig).map(key => dimensionConfig[key].name);
    
    const datasets = [];
    const levelNames = ['1çº§', '2çº§', '3çº§', '4çº§', '5çº§'];
    const colors = ['#ff6b6b', '#ffa94d', '#ffd43b', '#74c0fc', '#51cf66'];
    
    for (let i = 0; i < 5; i++) {
      const level = i + 1;
      const weight = level;
      
      datasets.push({
        label: levelNames[i],
        data: Object.keys(dimensionConfig).map(dimension => {
          const score = dimensionResults[dimension].levelScores[i];
          return (score * weight) / 15;
        }),
        backgroundColor: colors[i],
        borderWidth: 0
      });
    }
    
    charts.stacked = new Chart(ctx, {
      type: 'bar',
      data: { labels, datasets },
      options: {
        responsive: true,
        maintainAspectRatio: true,
        scales: {
          x: {
            stacked: true,
            ticks: {
              font: { size: 13, weight: 'bold', family: "'Microsoft YaHei', Arial, sans-serif" }
            }
          },
          y: {
            stacked: true,
            ticks: {
              callback: value => value.toFixed(1) + '%',
              font: { size: 12, family: "'Microsoft YaHei', Arial, sans-serif" }
            }
          }
        },
        plugins: {
          legend: {
            position: 'top',
            labels: {
              font: { size: 13, weight: 'bold', family: "'Microsoft YaHei', Arial, sans-serif" }
            }
          },
          tooltip: {
            callbacks: {
              label: function(context) {
                const label = context.dataset.label || '';
                const value = context.parsed.y.toFixed(1);
                return label + ': ' + value + '% (åŠ æƒè´¡çŒ®)';
              }
            }
          }
        }
      }
    });
  }

  function hexToRgba(hex, alpha) {
    const r = parseInt(hex.slice(1, 3), 16);
    const g = parseInt(hex.slice(3, 5), 16);
    const b = parseInt(hex.slice(5, 7), 16);
    return `rgba(${r},${g},${b},${alpha})`;
  }
</script>
</body>
</html>